<!DOCTYPE html><html lang="en">
<head>
  <meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>SOAP Notes</title>
  <link rel="stylesheet" href="/light.css?v=101" />
  <style>
    :root{color-scheme:light}
    body{background:#fff;color:#111;font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif}
    .page{max-width:1360px;margin:20px auto;padding:0 16px}
    .grid{display:grid;gap:16px}
    .grid-2{grid-template-columns:1fr}
    @media(min-width:1024px){.grid-2{grid-template-columns:1.15fr 0.85fr}}
    .card{background:#fff;border:1px solid #e5e7eb;border-radius:12px;overflow:hidden}
    .card h3{margin:0;padding:12px 14px;border-bottom:1px solid #eee;font-size:15px;color:#111}
    .card .body{padding:14px}
    .row{display:grid;gap:12px}
    .row-2{grid-template-columns:1fr 1fr}
    .row-3{grid-template-columns:1fr 1fr 1fr}
    @media(max-width:720px){.row-2,.row-3{grid-template-columns:1fr}}
    label{font-size:12px;color:#374151;display:block;margin-bottom:6px}
    input[type=text],textarea,select{width:100%;padding:10px 12px;border:1px solid #e5e7eb;border-radius:8px;background:#fff;color:#111;font-size:14px}
    textarea{min-height:110px;resize:vertical}
    .hint{font-size:12px;color:#6b7280}
    .btns{display:flex;flex-wrap:wrap;gap:10px;margin-top:8px}
    .button{border-radius:8px;padding:10px 14px;border:1px solid #e5e7eb;cursor:pointer;font-weight:600;background:#fff}
    .primary{background:#e0f2fe}
    .accent{background:#dcfce7}
    .warn{background:#fde68a}
    .info{background:#f3e8ff}
    pre#soapTextOut{min-height:240px;max-height:66vh;overflow:auto;background:#fff;color:#111;border:1px solid #e5e7eb;border-radius:8px;padding:12px;white-space:pre-wrap;word-break:break-word;margin:0}
    #icdOut{min-height:120px}
  </style>

  <script src="/fix-dropdowns.js?v=9101" defer></script>
  <script src="/app.js?v=1001" defer></script>
  <script src="/icd-fix.js" defer></script>

<style id="box-sizing-fix">
  /* Ensure inputs/textarea/select don't overflow their container */
  input[type=text], textarea, select {
    box-sizing: border-box !important;
    max-width: 100% !important;
    display: block;
  }
</style>

</head>
<body>
  <div class="page">
    <div id="status" class="hint"></div>
    <div class="grid grid-2">
      <div class="grid">
        <div class="card">
          <h3>Patient & Setup</h3>
          <div class="body">
            <div class="row row-2">
              <div><label for="patient">Patient</label><input id="patient" type="text" /></div>
              <div><label for="provider">Clinician</label><input id="provider" type="text" /></div>
            </div>
            <div class="row row-2" style="margin-top:12px;">
              <div><label for="clinic">Clinic/Practice (PDF header)</label><input id="clinic" type="text" /></div>
              <div><label for="model">Model <span id="modelHint" class="hint"></span></label><select id="model"></select></div>
            </div>
            <div class="row row-2" style="margin-top:12px;">
              <div><label for="specialty">Specialty <span id="specCount" class="hint"></span></label><select id="specialty"></select></div>
              <div style="display:flex;gap:12px;align-items:center;padding-top:18px">
                <label style="display:flex;gap:6px;align-items:center"><input type="checkbox" id="allowInference"/> Allow light inference</label>
                <label style="display:flex;gap:6px;align-items:center"><input type="checkbox" id="includeICD" checked/> Include ICD-10 suggestions</label>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <h3>Chief Complaint / HPI</h3>
          <div class="body">
            <textarea id="rawText" placeholder=""></textarea>
<div class="btns">
  <button id="btnGenerate" class="button primary" type="button">Generate SOAP</button>
  <button id="btnClear" class="button" type="button">Clear Patient Data</button>
  <button id="genStream" class="button info" type="button">Print</button>
  <button id="saveNote" class="button accent" type="button">Word Doc</button>
  <button id="exportPdf" class="button warn" type="button">Export PDF</button>
</div>
<div id="belowBtnsData" class="row" style="margin-top:8px"><div class="row row-3"><div><label for="vBP">BP</label><input id="vBP" type="text"/></div><div><label for="vHR">HR</label><input id="vHR" type="text"/></div><div><label for="vRR">RR</label><input id="vRR" type="text"/></div></div><div class="row row-2" style="margin-top:8px"><div><label for="patientHistory">Patient History</label><textarea id="patientHistory"></textarea></div><div><label for="labs">Labs (name=value per line)</label><textarea id="labs"></textarea><label for="imaging" style="margin-top:8px;display:block">Imaging (one study per line)</label><textarea id="imaging"></textarea></div></div></div>
<div id="underButtonsControls" class="row" style="margin-top:8px;display:flex;gap:12px;align-items:center"><label style="display:flex;gap:6px;align-items:center"><input type="checkbox" id="toggleEditable" checked/> Editable</label><button id="btnCopy" class="button" type="button">Copy</button></div>
            
            <div id="downloads" class="hint" style="margin-top:8px;"></div>
          </div>
        </div>
      </div>
      <div class="grid">
        <div class="card">
          <h3>Generated SOAP Note</h3>
          <div class="body"><pre id="soapTextOut" contenteditable="true" tabindex="0"></pre></div>
        </div>
        <div class="card">
          <h3>ICD-10 Suggestions</h3>
          <div class="body"><div id="icdOut" class="hint"></div></div>
        </div>
      </div>
    </div>
  </div>

  <script src="/persist-ui.js" defer></script>
  <script id="spec-loader-override">
  document.addEventListener('DOMContentLoaded',function(){
    function fill(arr){
      var sel=document.getElementById('specialty'); if(!sel) return;
      sel.innerHTML='';
      (arr||[]).forEach(function(v){
        v=String(v||'').trim(); if(!v) return;
        var o=document.createElement('option'); o.value=v; o.textContent=v; sel.appendChild(o);
      });
      var h=document.getElementById('specCount'); if(h) h.textContent='('+sel.options.length+' loaded)';
    }
    function load(){
      fetch('/disciplines.json').then(function(r){return r.json()}).then(function(d){
        var list=Array.isArray(d)?d:(d&&Array.isArray(d.items)?d.items:(d&&Array.isArray(d.disciplines)?d.disciplines:[]));
        list=Array.from(new Set((list||[]).map(function(x){return String(x||'').trim()}).filter(Boolean))).sort(function(a,b){return a.localeCompare(b)});
        if(!list.length) list=['General Practice','Family Medicine','Internal Medicine'];
        fill(list);
      }).catch(function(){
        fill(['General Practice','Family Medicine','Internal Medicine']);
      });
    }
    load(); setTimeout(load,0);
  });
  </script>
  <script src="/generate-stable.js?v=1" defer></script>
  <script src="/clear-stable.js?v=1" defer></script>
  <script src="/actions-stable.js?v=7001" defer></script>

<script src="/ui-below-buttons.js?v=18" defer></script>
</body></html>